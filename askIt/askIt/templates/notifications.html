{% extends 'home.html' %}

{% block cssStatic %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  	<script>
		$(document).on('click',".close-click",function(){
            console.log('button pressed');
            var closeid = $(this).data('answer');
            console.log(closeid);
            $.ajax({
            url: "notifications",
            type: "POST",
            data: {
              'notification' : closeid
            },
            success: function(response){
              console.log(response.notify)
              output="";
              console.log(output)
              x=response.notify;
              for(i=0;i<x.length;i++){
                output += '<div data-answer='+
                x[i].id+
                ' href="answers/ '+
                x[i].qID+
                '" class="list-group-item list-group-item-action click-check"> <div class="row"> <div class="col"> <a href ="answers/ '+
                x[i].id+
                '" <h5 class="mb-1">'+
                x[i].question+
                '</h5> </a> </div> <div class="col-2"> <div class="float right"> <button data-answer='+
                x[i].id+
                ' type="button" class="close close-click" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div> </div> </div> <div class="row"> <div class="col"> <p class="mb-1">'+
                x[i].answer+
                '</p> </div> </div> <div class="row"> <div class="col"> <small>'+
                x[i].whoAsked+
                '</small> </div> <div class="col-2"> <div class="float-right"> <small>'+
                x[i].datetime+
                '</small> </div> </div> </div> <div class="row"> <div class="col">'

                if (x[i].is_seen == false){
                  output += '<span class="badge badge-success">new</span>'
                }
                
                output += '</div> </div></div>'
              }
              $("#notify").html(output);
            }

          });
		});
	</script>
{% endblock cssStatic %}

{% block post1 %}
    <div class="col pt-2" >
        <div class="main shadow pb-2" style="background-color:white">
            {% comment %} this is blogPost  {% endcomment %}
              <div class="container-fluid">
                <div class="list-group mt-5">
                  <a style="background-color:rgb(61,104,121);" class="list-group-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between">
                      <h4 style="color:White;" class="mb-1">Notifications</h4>
                    </div>
                  </a >
                        <div id="notify">
                          {% for i in context.notifications %}
                          <div data-answer="{{i.id}}"  class="list-group-item list-group-item-action click-check"> 
                              <div class="row">
                                <div class="col">
                                  <a href="answers/{{i.qID}}" 
                                    <h5 class="mb-1"> {{i.question}} </h5>
                                  </a>
                                </div>
                                <div class="col-2">
                                  <div class="float right">
                                    <button data-answer="{{i.id}}" type="button" class="close close-click" aria-label="Close">
                                      <span aria-hidden="true">&times;</span>
                                    </button>
                                  </div>
                                </div>
                              </div>
                              <div class="row">
                                <div class="col">
                                  <p class="mb-1">{{i.answer}}</p>
                                </div>
                              </div>
                              <div class="row">
                                <div class="col">
                                  <small>{{i.whoAsked}}</small>
                                </div>
                                <div class="col-2">
                                  <div class="float-right">
                                      <small>{{i.datetime}}</small>
                                  </div>
                                  
                                </div>
                              </div>
                              <div class="row">
                                <div class="col">
                                  {% if i.is_seen == False %}
                                    <span class="badge badge-success">new</span>
                                  {% endif %}
                                </div>
                              </div>
                          </div> 
                          {% endfor %}
                        </div>
                     
                </div>
              </div>
            {% comment %} end main {% endcomment %}
        </div> 
     </div>

{% endblock post1 %}